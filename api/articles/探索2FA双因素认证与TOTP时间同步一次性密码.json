{"title":"探索2FA双因素认证与TOTP时间同步一次性密码","uid":"d06e89d326c3b959da197d0b11709006","slug":"探索2FA双因素认证与TOTP时间同步一次性密码","date":"2024-03-02T04:06:33.000Z","updated":"2024-03-02T04:11:13.168Z","comments":true,"path":"api/articles/探索2FA双因素认证与TOTP时间同步一次性密码.json","keywords":null,"cover":null,"content":"<h1 id=\"2FA-Two-Factor-Authentication-与-TOTP-Time-Based-One-Time-Password\"><a href=\"#2FA-Two-Factor-Authentication-与-TOTP-Time-Based-One-Time-Password\" class=\"headerlink\" title=\"2FA (Two-Factor Authentication) 与 TOTP (Time-Based One-Time Password)\"></a>2FA (Two-Factor Authentication) 与 TOTP (Time-Based One-Time Password)</h1><h2 id=\"引言\"><a href=\"#引言\" class=\"headerlink\" title=\"引言\"></a>引言</h2><p>在当今数字化时代，信息安全的重要性日益凸显，传统的单一密码登录方式已经无法满足高效且安全的身份验证需求。因此，双因素认证（2FA, Two-Factor Authentication）应运而生，作为一项关键的安全措施，它要求用户提供两个独立的证明身份的方式，显著提高了账户安全性。其中，基于时间的一次性密码（TOTP, Time-Based One-Time Password）是2FA中的一个重要实现方案。</p>\n<h2 id=\"什么是2FA（双因素认证）\"><a href=\"#什么是2FA（双因素认证）\" class=\"headerlink\" title=\"什么是2FA（双因素认证）\"></a>什么是2FA（双因素认证）</h2><p>双因素认证（2FA）是一种多层次的身份验证机制，旨在确保只有授权用户能够访问受保护的资源。根据NIST（美国国家标准与技术研究院）的定义，它结合了以下至少两种认证因素：</p>\n<ol>\n<li><strong>知识因素</strong>：只有用户知道的信息，如密码、PIN码或者安全问题的答案；</li>\n<li><strong>所有权因素</strong>：用户拥有的物理设备或虚拟凭证，如智能手机、USB令牌、短信验证码或生物特征；</li>\n<li><strong>内在因素</strong>：用户固有的生物特征，如指纹、面部识别或虹膜扫描。</li>\n</ol>\n<h2 id=\"TOTP（时间同步一次性密码）原理\"><a href=\"#TOTP（时间同步一次性密码）原理\" class=\"headerlink\" title=\"TOTP（时间同步一次性密码）原理\"></a>TOTP（时间同步一次性密码）原理</h2><p>TOTP 是2FA的一个具体实现，它基于时间的一次性密码算法。在这个机制下，用户和服务器双方共同持有预先共享的秘密密钥。每隔一段固定的时间间隔（通常为30秒），双方都会根据当前时间戳和此密钥通过HMAC（Hash-based Message Authentication Code）算法计算出一个唯一的、短暂有效的动态密码。</p>\n<h3 id=\"工作流程\"><a href=\"#工作流程\" class=\"headerlink\" title=\"工作流程\"></a>工作流程</h3><ol>\n<li><p><strong>密钥生成与存储</strong>：</p>\n<ul>\n<li>用户在启用TOTP时，会生成一个基于特定算法的密钥，并将其保存在服务器端和用户端（通常是手机上的认证APP）。</li>\n</ul>\n</li>\n<li><p><strong>时间同步</strong>：</p>\n<ul>\n<li>TOTP算法依赖于时间同步，客户端和服务端各自基于当前时间戳计算哈希值。</li>\n</ul>\n</li>\n<li><p><strong>密码生成</strong>：</p>\n<ul>\n<li>使用HMAC函数，将当前时间戳与共享密钥相结合生成一个哈希值。</li>\n<li>从哈希值中抽取一定长度的数值作为一次性密码。</li>\n</ul>\n</li>\n<li><p><strong>验证过程</strong>：</p>\n<ul>\n<li>当用户尝试登录时，在认证APP上获取并输入当前的有效TOTP密码。</li>\n<li>服务器同样根据当前时间戳计算TOTP密码，并与用户提交的密码进行比对，如果匹配，则验证成功。</li>\n</ul>\n</li>\n</ol>\n<p>总归来说，使用 TOTP 来进行 2FA 的第一步就是通过 QRCode Server 让跟 Client(App) 约定好一个秘密，之后就都用那个秘密跟接下来的时间来进行 Hash 。我们就按这个流程来评估每个步骤的安全性。</p>\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>TOTP作为双因素认证的重要组成部分，不仅强化了传统密码体系，而且在实施过程中具有简单易用、成本低廉的特点。随着越来越多的在线服务提供商采用2FA和TOTP，这种基于时间的一次性密码技术已经成为提升账户安全性的主流手段之一。无论是企业级应用还是个人用户，启用TOTP能够有效抵御诸如网络钓鱼、密码猜测等常见安全威胁，保障数字资产和个人信息安全。</p>\n","feature":false,"text":"本文主要介绍了2FA双因素认证与TOTP时间同步一次性密码...","permalink":"/post/探索2FA双因素认证与TOTP时间同步一次性密码","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"编程","slug":"编程","count":15,"path":"api/categories/编程.json"},{"name":"安全","slug":"编程/安全","count":1,"path":"api/categories/编程/安全.json"}],"tags":[{"name":"官方","slug":"官方","count":16,"path":"api/tags/官方.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#2FA-Two-Factor-Authentication-%E4%B8%8E-TOTP-Time-Based-One-Time-Password\"><span class=\"toc-text\">2FA (Two-Factor Authentication) 与 TOTP (Time-Based One-Time Password)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BC%95%E8%A8%80\"><span class=\"toc-text\">引言</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%80%E4%B9%88%E6%98%AF2FA%EF%BC%88%E5%8F%8C%E5%9B%A0%E7%B4%A0%E8%AE%A4%E8%AF%81%EF%BC%89\"><span class=\"toc-text\">什么是2FA（双因素认证）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#TOTP%EF%BC%88%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E4%B8%80%E6%AC%A1%E6%80%A7%E5%AF%86%E7%A0%81%EF%BC%89%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">TOTP（时间同步一次性密码）原理</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B\"><span class=\"toc-text\">工作流程</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BB%93%E8%AE%BA\"><span class=\"toc-text\">结论</span></a></li></ol></li></ol>","author":{"name":"LaoShui","slug":"blog-author","avatar":"favicon.ico","link":"/","description":"<p>不忘初心，青春朝气永在</p><p>志在千秋，百年恰是少年</p>","socials":{"github":"https://github.com/laoshuikaixue","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"aliyun_developer":{"icon":"/svg/aliyun.svg","link":"https://developer.aliyun.com/profile/dtvevsc2d4xha"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"开源：升学E网通绕过会员以及点击检测（已失效）","uid":"c0cbd51e6cc6162b96e9aed7b5281420","slug":"开源：升学E网通绕过会员以及点击检测","date":"2024-07-18T07:37:54.000Z","updated":"2024-08-22T05:33:02.410Z","comments":true,"path":"api/articles/开源：升学E网通绕过会员以及点击检测.json","keywords":null,"cover":[],"text":"本文分享了对升学E网通的研究开源项目...","permalink":"/post/开源：升学E网通绕过会员以及点击检测","photos":[],"count_time":{"symbolsCount":955,"symbolsTime":"1 mins."},"categories":[{"name":"开源","slug":"开源","count":1,"path":"api/categories/开源.json"},{"name":"编程","slug":"开源/编程","count":1,"path":"api/categories/开源/编程.json"}],"tags":[{"name":"官方","slug":"官方","count":16,"path":"api/tags/官方.json"}],"author":{"name":"LaoShui","slug":"blog-author","avatar":"favicon.ico","link":"/","description":"<p>不忘初心，青春朝气永在</p><p>志在千秋，百年恰是少年</p>","socials":{"github":"https://github.com/laoshuikaixue","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"aliyun_developer":{"icon":"/svg/aliyun.svg","link":"https://developer.aliyun.com/profile/dtvevsc2d4xha"}}}},"feature":false},"next_post":{"title":"Python 快速排序：原理、使用场景与实现方法","uid":"70c15220323e313ec6083d38a84c2668","slug":"Python-快速排序：原理、使用场景与实现方法","date":"2024-02-09T08:31:40.000Z","updated":"2024-02-09T08:35:26.136Z","comments":true,"path":"api/articles/Python-快速排序：原理、使用场景与实现方法.json","keywords":null,"cover":[],"text":"本文主要介绍了Python 快速排序：原理、使用场景与实现方法...","permalink":"/post/Python-快速排序：原理、使用场景与实现方法","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"编程","slug":"编程","count":15,"path":"api/categories/编程.json"},{"name":"Python","slug":"编程/Python","count":12,"path":"api/categories/编程/Python.json"}],"tags":[{"name":"官方","slug":"官方","count":16,"path":"api/tags/官方.json"}],"author":{"name":"LaoShui","slug":"blog-author","avatar":"favicon.ico","link":"/","description":"<p>不忘初心，青春朝气永在</p><p>志在千秋，百年恰是少年</p>","socials":{"github":"https://github.com/laoshuikaixue","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"aliyun_developer":{"icon":"/svg/aliyun.svg","link":"https://developer.aliyun.com/profile/dtvevsc2d4xha"}}}},"feature":false}}